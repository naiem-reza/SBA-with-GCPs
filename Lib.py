import os
import copy
import laspy
import time
import math
import threading
import numpy as np
import pandas as pd
import xmltodict
import scipy.stats
from scipy import spatial
import pyransac3d as pyrsc
import open3d as o3d
from ismember import ismember
import matplotlib.pyplot as plt
from matplotlib import image
from numpy.matlib import repmat
from scipy.sparse import linalg as splinalg
import scipy.sparse as sparse
from numpy.linalg import inv as npinv
from sklearn.neighbors import KDTree
from scipy.sparse import lil_matrix, bsr_matrix, coo_matrix, bsr_matrix

# ------------------------------------------------------------------ Read Cameras EOPs and IOP File
def ReadIOPFile(cam_path):
    xml_data = open(cam_path, 'r').read()  # Read data
    data = xmltodict.parse(xml_data)  # Parse XML
    iop = []
    for i in data['calibration']:
        child = data['calibration'][i]
        iop.append(child)

    if len(iop) <= 5:
        w = float(iop[1])
        h = float(iop[2])
        f = float(iop[3])
        IOP = [w, h, f, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    else:
        w = float(iop[1])
        h = float(iop[2])
        f = float(iop[3])
        cx = float(iop[4])
        cy = float(iop[5])
        b1 = float(iop[6])
        b2 = float(iop[7])
        k1 = float(iop[8])
        k2 = float(iop[9])
        k3 = float(iop[10])
        p1 = float(iop[11])
        p2 = float(iop[12])
        IOP = [w, h, f, cx, cy, b1, b2, k1, k2, k3, p1, p2]
    return IOP
# ------------------------------------------------------------------ Import Data
def Import_Data(cwd):
    cam_path = cwd + '\\iop.xml'
    eop_path = cwd + '\\initial_eop.csv'
    xyz_path = cwd + '\\initial_tie.csv'
    img_obs_path = cwd + '\\img observation.csv'
    Control_path = cwd + '\\Control.csv'
    obj_obs_path = cwd + '\\obj observation.csv'

    IOP = ReadIOPFile(cam_path)
    EOP = np.asarray(pd.read_csv(eop_path, header=None).to_numpy(), dtype=float)
    initial_tie = np.asarray(pd.read_csv(xyz_path, header=None).to_numpy(), dtype=float)
    control = np.asarray(pd.read_csv(Control_path, header=None).to_numpy(), dtype=float)
    img_obs = np.asarray(pd.read_csv(img_obs_path, header=None).to_numpy(), dtype=float)
    obj_obs = np.asarray(pd.read_csv(obj_obs_path, header=None).to_numpy(), dtype=float)

    return EOP, IOP, initial_tie, control, img_obs, obj_obs
# ------------------------------------------------------------------ inverse block diagonal sparse matrix
def invers_block_diag_sparse(A):
    V = bsr_matrix(A)
    size = V.blocksize
    iV = copy.deepcopy(V)

    data = V.data
    idata = np.zeros((len(data), size[0], size[1]))
    for k in range(len(data)):
        idata[k, :, :] = npinv(data[k])

    iV.data = idata
    return iV.tocsr()

def JAC_1(params, n_cameras, n_points, camera_indices, Tie_indices, Gcp_indices, IOP):
    pi = math.pi
    camera_params = params[:n_cameras * 6].reshape((n_cameras, 6))
    points_3d = params[n_cameras * 6:].reshape((n_points, 3))
    m = (len(Tie_indices) * 2) + (len(Gcp_indices) * 3)
    n = n_cameras * 6 + n_points * 3
    A = lil_matrix((m, n), dtype=float)
    eop = camera_params[camera_indices]
    XYZ = points_3d[Tie_indices]

    X = XYZ[:, 0]
    Y = XYZ[:, 1]
    Z = XYZ[:, 2]

    W = IOP[0]
    H = IOP[1]
    f = IOP[2]
    cx = IOP[3]
    cy = IOP[4]
    B1 = IOP[5]
    B2 = IOP[6]
    K1 = IOP[7]
    K2 = IOP[8]
    K3 = IOP[9]
    P1 = IOP[10]
    P2 = IOP[11]

    X0 = eop[:, 0]
    Y0 = eop[:, 1]
    Z0 = eop[:, 2]
    w = (eop[:, 3] * pi) / 180
    p = (eop[:, 4] * pi) / 180
    k = (eop[:, 5] * pi) / 180

    i = np.arange(len(Tie_indices))
    for s in range(6):
        if s == 0:
            dx_dX0 = B1*((((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(k)*np.cos(p)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + f*((((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(k)*np.cos(p)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B2*(P2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(k)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dX0 = -f*(P2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(k)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, camera_indices * 6 + s] = dx_dX0
            A[2 * i + 1, camera_indices * 6 + s] = dy_dX0

        elif s == 1:
            dx_dY0 = B2*(P2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B1*(((np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + (((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - f*(((np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + (((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dY0 = f*(P2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, camera_indices * 6 + s] = dx_dY0
            A[2 * i + 1, camera_indices * 6 + s] = dy_dY0

        elif s == 2:
            dx_dZ0 = B2*(P2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P1*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B1*(((np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - f*(((np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dZ0 = f*(P2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P1*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, camera_indices * 6 + s] = dx_dZ0
            A[2 * i + 1, camera_indices * 6 + s] = dy_dZ0

        elif s == 3:
            dx_dw = - B1*(P1*((6*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) - ((K1*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - ((np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B2*(P2*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + ((K1*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P1*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - f*(P1*((6*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) - ((K1*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - ((np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dw = -f*(P2*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + ((K1*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P1*((Y - Y0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - (Z - Z0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*((Y - Y0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) - (Z - Z0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*(np.cos(p)*np.cos(w)*(Y - Y0) + np.cos(p)*np.sin(w)*(Z - Z0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, camera_indices * 6 + s] = dx_dw
            A[2 * i + 1, camera_indices * 6 + s] = dy_dw

        elif s == 4:
            dx_dp = B2*(P2*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - ((np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - f*(((np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B1*(((np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dp = f*(P2*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - ((np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(np.cos(k)*np.sin(p)*(X - X0) + np.cos(k)*np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(k)*np.cos(p)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(np.sin(k)*np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*np.sin(k)*(Z - Z0) - np.cos(p)*np.sin(k)*np.sin(w)*(Y - Y0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*(np.cos(p)*(X - X0) - np.cos(w)*np.sin(p)*(Z - Z0) + np.sin(p)*np.sin(w)*(Y - Y0))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, camera_indices * 6 + s] = dx_dp
            A[2 * i + 1, camera_indices * 6 + s] = dy_dp

        elif s == 5:
            dx_dk = B1*((((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + f*((((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + B2*((((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)
            dy_dk = f*((((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)
            A[2 * i, camera_indices * 6 + s] = dx_dk
            A[2 * i + 1, camera_indices * 6 + s] = dy_dk

    for s in range(3):
        if s == 0:
            dx_dX = B2*(P2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(k)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - f*((((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(k)*np.cos(p)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B1*((((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(k)*np.cos(p)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dX = f*(P2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (np.sin(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(k)*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*np.cos(p)*np.sin(k)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P1*np.cos(k)*np.cos(p)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.sin(p)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, n_cameras * 6 + Tie_indices * 3 + s] = dx_dX
            A[2 * i + 1, n_cameras * 6 + Tie_indices * 3 + s] = dy_dX

        elif s == 1:
            dx_dY = B1*(((np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + (((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B2*(P2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + f*(((np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + (((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dY = -f*(P2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (6*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 + (2*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P1*np.cos(p)*np.sin(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, n_cameras * 6 + Tie_indices * 3 + s] = dx_dY
            A[2 * i + 1, n_cameras * 6 + Tie_indices * 3 + s] = dy_dY

        elif s == 2:
            dx_dZ = B1*(((np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) - B2*(P2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P1*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + f*(((np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - P1*((6*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + (2*P2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*P2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (4*P2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            dy_dZ = -f*(P2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (6*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (6*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + ((np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) + ((K1*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 3*K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3) + 2*K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)*((2*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (2*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3 - (2*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2)/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0)) - (2*P1*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (2*P1*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p))*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 - (np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))*(K1*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2) + K2*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**2 + K3*(((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + ((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0))**2/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2)**3 + 1))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**2 + (4*P1*np.cos(p)*np.cos(w)*((Y - Y0)*(np.cos(w)*np.sin(k) + np.cos(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.sin(k)*np.sin(w) - np.cos(k)*np.cos(w)*np.sin(p)) + np.cos(k)*np.cos(p)*(X - X0))*((Y - Y0)*(np.cos(k)*np.cos(w) - np.sin(k)*np.sin(p)*np.sin(w)) + (Z - Z0)*(np.cos(k)*np.sin(w) + np.cos(w)*np.sin(k)*np.sin(p)) - np.cos(p)*np.sin(k)*(X - X0)))/(np.sin(p)*(X - X0) + np.cos(p)*np.cos(w)*(Z - Z0) - np.cos(p)*np.sin(w)*(Y - Y0))**3)
            A[2 * i, n_cameras * 6 + Tie_indices * 3 + s] = dx_dZ
            A[2 * i + 1, n_cameras * 6 + Tie_indices * 3 + s] = dy_dZ

    i = np.arange(len(Tie_indices) * 2, len(Tie_indices) * 2 + len(Gcp_indices) * 3, 3)
    for s in range(3):
        A[i, n_cameras * 6 + Gcp_indices * 3 + s] = 1
        A[i + 1, n_cameras * 6 + Gcp_indices * 3 + s] = 1
        A[i + 2, n_cameras * 6 + Gcp_indices * 3 + s] = 1

    return A

def FUNC_1(params, n_cameras, n_points, camera_indices, Tie_indices, Gcp_indices, points_2d, Obsgcp, IOP):
    camera = params[:n_cameras * 6].reshape((n_cameras, 6))
    points = params[n_cameras * 6:].reshape((n_points, 3))

    XYZ = points[Tie_indices]
    pro_gcp = points[Gcp_indices]

    eop = camera[camera_indices]

    pi = math.pi
    w = (eop[:, 3] * pi) / 180
    p = (eop[:, 4] * pi) / 180
    k = (eop[:, 5] * pi) / 180

    rr = []
    for i in range(len(eop)):
        Omega = w[i]
        Phi = p[i]
        Kapa = k[i]
        R = np.asarray([[np.cos(Kapa) * np.cos(Phi), np.cos(Omega) * np.sin(Kapa) + np.cos(Kapa) * np.sin(Omega) * np.sin(Phi), np.sin(Kapa) * np.sin(Omega) - np.cos(Kapa) * np.cos(Omega) * np.sin(Phi)],
                        [-np.cos(Phi) * np.sin(Kapa), np.cos(Kapa) * np.cos(Omega) - np.sin(Kapa) * np.sin(Omega) * np.sin(Phi), np.cos(Kapa) * np.sin(Omega) + np.cos(Omega) * np.sin(Kapa) * np.sin(Phi)],
                        [np.sin(Phi), -np.cos(Phi) * np.sin(Omega), np.cos(Omega) * np.cos(Phi)]])
        rr.append(R)

    t = XYZ - eop[:, :3]
    XYZ_cam = []
    for j in range(len(eop)):
        XYZ_cam.append((rr[j] @ t[j, :].T).T)
    XYZ_camera = np.asarray(XYZ_cam)

    w = IOP[0]
    h = IOP[1]
    f = IOP[2]
    cx = IOP[3]
    cy = IOP[4]
    B1 = IOP[5]
    B2 = IOP[6]
    K1 = IOP[7]
    K2 = IOP[8]
    K3 = IOP[9]
    P1 = IOP[10]
    P2 = IOP[11]

    xp = -(XYZ_camera[:, 0] / XYZ_camera[:, 2])
    yp = (XYZ_camera[:, 1] / XYZ_camera[:, 2])

    r = np.sqrt(xp ** 2 + yp ** 2)
    dx = xp * (1 + K1 * (r ** 2) + K2 * (r ** 4) + K3 * (r ** 6)) + (P1 * ((r ** 2) + 2 * (xp ** 2))) + (2 * P2 * (xp * yp))
    dy = yp * (1 + K1 * (r ** 2) + K2 * (r ** 4) + K3 * (r ** 6)) + (P2 * ((r ** 2) + 2 * (yp ** 2))) + (2 * P1 * (xp * yp))

    u = w * 0.5 + cx + dx * f + dx * B1 + dy * B2
    v = h * 0.5 + cy + dy * f

    res = np.column_stack((points_2d[:, 0] - u, points_2d[:, 1] - v)).ravel()
    resgcp = (pro_gcp - Obsgcp).ravel()

    return np.hstack((res, resgcp)), np.column_stack((u, v))


